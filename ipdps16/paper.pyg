count_scan = scan(bucket_counts);
for (int q=npes>>1; q; q>>=1) {
  if(count_scan[offset+q] > midP)
    midP >>= 1
  else {
    new_rank += q;
    offset += q;
    midP += midP>>1;
  }
}
